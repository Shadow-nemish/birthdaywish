<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Happy Birthday!</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: radial-gradient(circle, #ffe0b5, #ffb347);
      overflow-x: hidden;
    }

    .container {
      text-align: center;
      padding: 50px 20px;
    }

    .card {
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 15px 25px rgba(0,0,0,0.2);
      max-width: 600px;
      margin: auto;
      position: relative;
      z-index: 1;
    }

    h1 {
      color: #e91e63;
      font-size: 3em;
      animation: bounce 1s infinite alternate;
    }

    @keyframes bounce {
      to { transform: translateY(-10px); }
    }

    .balloons {
      font-size: 2em;
    }

    input, button {
      padding: 10px;
      font-size: 1em;
      margin-top: 15px;
      border: none;
      border-radius: 8px;
    }

    input {
      width: 80%;
      border: 1px solid #ccc;
    }

    button {
      background: #e91e63;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background: #c2185b;
    }

    .cake {
      font-size: 4em;
      margin: 20px 0;
    }

    #message {
      font-size: 1.2em;
      margin-top: 20px;
      color: #333;
      min-height: 50px;
    }

    #imagePreview {
      max-width: 200px;
      max-height: 200px;
      margin-top: 20px;
      border-radius: 10px;
      border: 2px dashed #ccc;
    }

    #downloadBtn {
      margin-top: 25px;
      display: none;
    }

    canvas#confetti, canvas#particles {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    /* Hidden custom card */
    #customCard {
      display: none;
      width: 600px;
      background: white;
      padding: 30px;
      text-align: center;
      border-radius: 15px;
      box-shadow: 0 15px 25px rgba(0,0,0,0.2);
      font-family: 'Segoe UI', sans-serif;
    }

    #customCard h2 {
      color: #ff4081;
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    #customCard p {
      font-size: 1.2em;
      color: #444;
    }

    #customPhoto {
      max-width: 150px;
      border-radius: 10px;
      margin: 15px 0;
    }
  </style>
</head>
<body>

<!-- Effects -->
<canvas id="confetti"></canvas>
<canvas id="particles"></canvas>

<div class="container">
  <div class="card" id="card">
    <div class="balloons">üéàüéâüéà</div>
    <h1>Happy Birthday!</h1>

    <p>Enter your name:</p>
    <input type="text" id="nameInput" placeholder="Your Name"><br>

    <p>Select your photo (optional):</p>
    <input type="file" accept="image/*" id="photoInput"><br>
    <img id="imagePreview" src="#" alt="Preview" style="display: none;">

    <button onclick="celebrate()">Celebrate üéä</button>
    <div class="cake">üéÇ</div>
    <div id="message"></div>
    <button id="downloadBtn" onclick="prankAndDownload()">Download Card üì•</button>
  </div>
</div>

<!-- Music -->
<audio id="music" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

<!-- Hidden card layout for final download -->
<div id="customCard">
  <h2 id="cardTitle">Happy Birthday!</h2>
  <img id="customPhoto" src="" alt="Photo" style="display: none;">
  <p id="cardWish">
    Wishing you a day filled with love, laughter, and cake! üéÇ May your year ahead sparkle with joy and success. ‚ú®
  </p>
  <p id="cardName"></p>
</div>

<!-- html2canvas for rendering the downloadable card -->
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>
  let userName = '';
  let uploadedPhoto = '';

  function celebrate() {
    const name = document.getElementById('nameInput').value;
    const music = document.getElementById('music');
    const messageEl = document.getElementById('message');

    if (!name.trim()) {
      messageEl.innerHTML = "Please enter your name! üéÅ";
      return;
    }

    userName = name;
    messageEl.innerHTML = `üéà Happy Birthday, <strong>${name}</strong>! Wishing you a day full of joy! üéÇ`;
    music.play();
    startConfetti();
    document.getElementById('downloadBtn').style.display = 'inline-block';
  }

  document.getElementById('photoInput').addEventListener('change', function () {
    const reader = new FileReader();
    reader.onload = function (e) {
      uploadedPhoto = e.target.result;
      const img = document.getElementById('imagePreview');
      img.src = uploadedPhoto;
      img.style.display = "block";
    };
    if (this.files[0]) reader.readAsDataURL(this.files[0]);
  });

  function prankAndDownload() {
    const messageEl = document.getElementById("message");
    messageEl.innerHTML = "‚ö†Ô∏è WARNING: Card is locked! Initiating self-destruct in 3... üí£";

    let count = 2;
    const prankInterval = setInterval(() => {
      if (count > 0) {
        messageEl.innerHTML = `‚ö†Ô∏è WARNING: Card is locked! Initiating self-destruct in ${count}... üí£`;
        count--;
      } else {
        clearInterval(prankInterval);
        messageEl.innerHTML = "üéâ Just kidding! Here's your beautiful card üòÑ";

        setTimeout(() => {
          createAndDownloadCard();
        }, 1000);
      }
    }, 1000);
  }

  function createAndDownloadCard() {
    const card = document.getElementById('customCard');
    document.getElementById('cardName').innerHTML = `With love, <strong>${userName}</strong> üéÅ`;
    if (uploadedPhoto) {
      const img = document.getElementById('customPhoto');
      img.src = uploadedPhoto;
      img.style.display = "block";
    }

    card.style.display = 'block';

    html2canvas(card).then(canvas => {
      const link = document.createElement('a');
      link.download = 'beautiful-birthday-card.png';
      link.href = canvas.toDataURL();
      link.click();

      card.style.display = 'none'; // Hide card after download
    });
  }

  // Confetti + Particles
  const confettiCanvas = document.getElementById('confetti');
  const ctx = confettiCanvas.getContext('2d');
  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;

  function randomColor() {
    return `hsl(${Math.random() * 360}, 100%, 50%)`;
  }

  let confetti = [];

  function startConfetti() {
    confetti = Array.from({ length: 100 }, () => ({
      x: Math.random() * confettiCanvas.width,
      y: -20,
      r: Math.random() * 6 + 4,
      color: randomColor(),
      speed: Math.random() * 3 + 2,
      tilt: Math.random() * 10 - 5
    }));
    animateConfetti();
  }

  function animateConfetti() {
    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
    confetti.forEach(p => {
      p.y += p.speed;
      p.x += Math.sin(p.y * 0.05);
      ctx.beginPath();
      ctx.fillStyle = p.color;
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fill();
    });
    confetti = confetti.filter(p => p.y < confettiCanvas.height);
    if (confetti.length > 0) requestAnimationFrame(animateConfetti);
  }

  const particlesCanvas = document.getElementById('particles');
  const particlesCtx = particlesCanvas.getContext('2d');
  particlesCanvas.width = window.innerWidth;
  particlesCanvas.height = window.innerHeight;

  let particles = Array.from({ length: 50 }, () => ({
    x: Math.random() * particlesCanvas.width,
    y: Math.random() * particlesCanvas.height,
    r: Math.random() * 2 + 1,
    dx: Math.random() * 0.5,
    dy: Math.random() * 0.5
  }));

  function animateParticles() {
    particlesCtx.clearRect(0, 0, particlesCanvas.width, particlesCanvas.height);
    particles.forEach(p => {
      p.x += p.dx;
      p.y += p.dy;
      if (p.x > particlesCanvas.width || p.y > particlesCanvas.height) {
        p.x = Math.random() * particlesCanvas.width;
        p.y = Math.random() * particlesCanvas.height;
      }
      particlesCtx.beginPath();
      particlesCtx.fillStyle = "rgba(255,255,255,0.5)";
      particlesCtx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      particlesCtx.fill();
    });
    requestAnimationFrame(animateParticles);
  }

  animateParticles();
</script>

</body>
</html>
